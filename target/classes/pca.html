<!DOCTYPE html>
<html>

<head>
    <link rel="stylesheet" href="styles.css">
</head>

<ul>
    <li><a href="home.html">Home</a></li>
    <li><a href="pca.html">PCA</a></li>
    <li><a href="admixture.html">Admixture</a></li>
    <li><a href="data.html">Data</a></li>
    <li><a href="install.html">Install</a></li>
</ul>

<h1>PCA Plots</h1>
<div class="images">
    <figure>
        <img src="pca-example.png" class="center" alt="pca graph">
        <figcaption>PCA Plot</figcaption>
    </figure>
</div>

<h2>Input Data Format</h2>
<p>Genesis takes as input one mandatory file, and one optional file:</p>
<ol>
    <li>The compulsory input file is a PCA file. In this version of the code, three input formats
        are supported: eigenstrat, plink, and SNPRelate.</li>
    <li>A phenotype file (see the description in the data tab), which labels each individual.
        In addition to plink-style phentoype files, eigenstrat pca.evec files are legal as
        input (the phentoype is often in the last column).
    </li>
</ol>

<p>We have scripts that convert from other popular PCA formats (PLINK, flashpca) to a format the Genesis understands.
    These scripts are discussed in the section Advice on data formats below. We hope that in future versions of Genesis
    that this will be handled natively.</p>

<h2>Data Input</h2>

<div class="images">
    <figure>
        <img src="pca-data-import.png" class="center" alt="pca data import">
        <figcaption>PCA Data Input</figcaption>
    </figure>
</div>
<p>First, create the project with the fam and phenotype file (optional) by clicking the New button.
    To input Eigenstrat or SNPRelate data files, click the PCA button on the left-hand side of the main Genesis Screen.
    On the screen that opens, click Import Data File and navigate to the PCA data file outputted by the
    Eigenstrat software or Relate package respectively.</p>

<p>In the drop-down menus, select the 2 PCAs to plot as the axes. The default PCAs are 1 and 2.
    The phenotype file imported when creating the project will be used to group the data. To draw the graph, click OK.
    The PCA button will be disabled after the graph is drawn. Use the "Data button" to create graphs with new PCAs.
</p>

<h2>Appearance Settings</h2>
If a graph has already been plotted, and you wish to change the axis labels or the heading,
click the "Settings button" on the main Genesis menu.

<div class="images">
    <figure>
        <img src="pca-settings.png" class="center" alt="pca settings">
        <figcaption>PCA Settings Dialog.</figcaption>
    </figure>
</div>

<h4>Heading and Axes</h4>
To set/change the heading or axes, open the settings menu above and type the heading or axis name
into the respective text box. To change the font of the heading/axis label, select the font, style, and size.
The color picker at the bottom is used to change the font colors.

Click "apply changes" checkboxes for the changes to be effected. Changes will not be applied on the labels whose
"apply changes" checkbox is not clicked/checked

<h4>Axes</h4>
<p>To show/hide the axes, axis labels, grid and scale, open the Setting menu
    and (un)check the relevant checkboxes.</p>

<h4>Borders</h4>
<p>To show/hide the border open the Setting menu and (un)check the Show
    Border checkbox.</p>

<h4>Legend</h4>
To change the position of the legend, right click on the legend item and select the position of the legend from the
dialog box below. The default legend position is right (right-hand side of the graph)

<div class="images">
    <figure>
        <img src="pca-legend-position.png" class="center" alt="pca legend position">
        <figcaption>PCA Legend Position Dialog</figcaption>
    </figure>
</div>

<h4>Selecting Subjects</h4>
<p>To select an individual subject on the structure plot, click on the subject on the plot.
This will bring up a subject menu where you can view the data about the subject (from
the phenotype data file) and gives options to change the subject's icon as well as to
    delete the subject and hide or place the subject on top.</p>

<div class="images">
    <figure width="40%">
        <img src="pca-subject-details.png" class="center" alt="pca subject details">
        <figcaption>PCA Subject Details</figcaption>
    </figure>
</div>

<h4>Changing Subject's Icon</h4>
<p>To change an individual subject's icon, click the subject on the graph and from the
    dialog that opens, select the icon shape and colour. Selecting the shape default will set
    the shape of the icon to the group's shape and checking Clear all icon data specific
    to this individual will set the icon's shape and colour to the group's.</p>

<h4>Placing a Subject on Top</h4>
To place an individual subject on top, click the subject on the graph and from the
dialog that opens, check the <em>Place this individual on top</em> checkbox and click Done.

<h4>Changing the Population Group Names</h4>
<p>//TODO</p>

<h4>Changing the Population Group Icons</h4>
To change a population group's icon, check the "Group icon data" button, select the name of the group, and
click the "Change Icon" button to select the icon and the color. This will launch the Icon Options dialog.
From here you can set the shape and colour of the icon. Clicking the OK button will change the selected population
group icon and color.

<h4>Changing the Order of Population Groups in the Key</h4>
<p>//TODO</p>

<h2>Annotating the Graph</h2>
<h4>Creating a Label</h4>
<p>To create a label and annotate the graph, click the annotate button.
    The menu with the shapes will appear at the bottom of the Genesis main screen.
    Click the shape you wish to add to make it appear on the chart.
    Drag the shape to where you want it to be placed on the chart.</p>

<h4>Editing or Deleting a Label</h4>
<p>To reposition a label, click on it and drag to where it should go. To edit a label that has
    been created, right click on the label to bring up the Label dialog. From this dialog you can
    edit the label&#39;s text, change its color or delete the label.
</p>

<h2>Hiding Subjects and Population Groups from the Graph</h2>
<h4>Hiding Subjects</h4>
<p>To hide a subject from the graph, click on the subject on the graph to bring up the
    subject dialog. From this menu you can choose to hide the subject from the graph.</p>

<h4>Hiding Groups</h4>
<p>//TODO</p>

<h4>Showing Hidden Subjects and Groups</h4>
<p>To reshow a subject that has been hidden, click on the Hidden Individuals button and from the drop-down menu
    that pops up, select the name of the subject or group that you wish to show. From the Hidden Individuals dialog,
    you can now un hide this Individual/group from the graph.</p>

<div class="images">
    <figure width="40%">
        <img src="pca-hidden-individuals.png" class="center" alt="pca subject details">
        <figcaption>PCA Hidden Individuals</figcaption>
    </figure>
</div>

<h4>Searching for a Subject</h4>
<p>To search for a subject in the graph by iid or fid, click the Search for individual button
    in the menu. In the dialog, enter the iid/fid of the individual you
    wish to find and click Ok. If the individual was found in the data, the individuals icon will grow in out.
    If the individual was not found, a message will be displayed.</p>

<h4>Rotating the Graph</h4>
<p>//TODO for 3D graphs</p>

<h4>Zoom</h4>
You can zoom the graph by selecting/dragging the mouse over the icons you wish to view. Press the ESC button to
restore the graph size.

</body>
</html>